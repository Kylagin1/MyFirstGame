<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–°—Ç—Ä–µ–ª—è–ª–∫–∞</title>
<style>
  body {
    margin: 0;
    background: #0a0f1c;
    color: white;
    font-family: Arial, sans-serif;
    text-align: center;
    overflow: hidden;
  }
  #gameCanvas {
    background: #111;
    display: block;
    margin: 20px auto;
    border: 2px solid #333;
  }
  #hud {
    display: flex;
    justify-content: center;
    gap: 20px;
    margin-top: 10px;
  }
  #controls {
    position: fixed;
    bottom: 20px;
    left: 0;
    width: 100%;
    display: flex;
    justify-content: space-between;
    padding: 0 30px;
  }
  .move-controls {
    display: grid;
    grid-template-areas:
      ". up ."
      "left . right"
      ". down .";
    gap: 10px;
  }
  .btn {
    width: 70px;
    height: 70px;
    border-radius: 50%;
    background: rgba(255, 204, 0, 0.9);
    border: 2px solid #000;
    font-size: 24px;
    font-weight: bold;
    color: black;
    display: flex;
    align-items: center;
    justify-content: center;
    user-select: none;
  }
  .btn:active {
    background: orange;
  }
  .shoot-btn {
    width: 90px;
    height: 90px;
    background: rgba(255, 80, 80, 0.9);
    font-size: 28px;
  }
</style>
</head>
<body>
<div id="hud">
  <div>–û—á–∫–∏: <span id="score">0</span></div>
  <div>–ñ–∏–∑–Ω–∏: <span id="lives">3</span></div>
  <button onclick="startGame()">–°—Ç–∞—Ä—Ç</button>
</div>
<canvas id="gameCanvas" width="400" height="500"></canvas>

<div id="controls">
  <div class="move-controls">
    <div style="grid-area: up;" class="btn" ontouchstart="keys.ArrowUp=true" ontouchend="keys.ArrowUp=false">‚Üë</div>
    <div style="grid-area: left;" class="btn" ontouchstart="keys.ArrowLeft=true" ontouchend="keys.ArrowLeft=false">‚Üê</div>
    <div style="grid-area: right;" class="btn" ontouchstart="keys.ArrowRight=true" ontouchend="keys.ArrowRight=false">‚Üí</div>
    <div style="grid-area: down;" class="btn" ontouchstart="keys.ArrowDown=true" ontouchend="keys.ArrowDown=false">‚Üì</div>
  </div>
  <div class="btn shoot-btn" ontouchstart="keys.Space=true" ontouchend="keys.Space=false">üî•</div>
</div>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

let player, bullets, enemies, score, lives, gameRunning;

// –∑–∞–≥—Ä—É–∂–∞–µ–º –∫–∞—Ä—Ç–∏–Ω–∫—É –≤—Ä–∞–≥–∞ (—Ç–≤–æ—ë —Ñ–æ—Ç–æ –≤ base64)
const enemyImg = new Image();
enemyImg.src = "data:image/png;base64,REPLACE_THIS_WITH_BIG_STRING";

let keys = {};

document.addEventListener("keydown", e => keys[e.code] = true);
document.addEventListener("keyup", e => keys[e.code] = false);

function startGame() {
  player = { x: canvas.width/2 - 15, y: canvas.height - 40, w: 30, h: 30, color: "cyan" };
  bullets = [];
  enemies = [];
  score = 0;
  lives = 3;
  gameRunning = true;
  spawnEnemy();
  requestAnimationFrame(update);
}

function spawnEnemy() {
  if (!gameRunning) return;
  const x = Math.random() * (canvas.width - 40);
  enemies.push({ x, y: -50, w: 40, h: 40, speed: 2 });
  setTimeout(spawnEnemy, 2000 + Math.random() * 2000);
}

function update() {
  if (!gameRunning) return;

  ctx.clearRect(0,0,canvas.width,canvas.height);

  // —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
  if (keys["ArrowLeft"] && player.x > 0) player.x -= 4;
  if (keys["ArrowRight"] && player.x < canvas.width - player.w) player.x += 4;
  if (keys["Space"]) shoot();

  // –ø—É–ª–∏
  bullets.forEach((b, i) => {
    b.y -= 6;
    if (b.y < 0) bullets.splice(i,1);
  });

  // –≤—Ä–∞–≥–∏
  enemies.forEach((en, i) => {
    en.y += en.speed;
    if (en.y > canvas.height) {
      enemies.splice(i,1);
      lives--;
      if (lives <= 0) gameOver();
    }
  });

  // —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è
  bullets.forEach((b, bi) => {
    enemies.forEach((en, ei) => {
      if (b.x < en.x+en.w && b.x+b.w > en.x && b.y < en.y+en.h && b.y+b.h > en.y) {
        bullets.splice(bi,1);
        enemies.splice(ei,1);
        score += 10;
      }
    });
  });

  // —Ä–∏—Å—É–µ–º –∏–≥—Ä–æ–∫–∞
  ctx.fillStyle = player.color;
  ctx.fillRect(player.x, player.y, player.w, player.h);

  // —Ä–∏—Å—É–µ–º –ø—É–ª–∏
  ctx.fillStyle = "yellow";
  bullets.forEach(b => ctx.fillRect(b.x,b.y,b.w,b.h));

  // —Ä–∏—Å—É–µ–º –≤—Ä–∞–≥–æ–≤
  enemies.forEach(en => {
    ctx.drawImage(enemyImg, en.x, en.y, en.w, en.h);
  });

  document.getElementById("score").innerText = score;
  document.getElementById("lives").innerText = lives;

  requestAnimationFrame(update);
}

function shoot() {
  if (bullets.length === 0 || bullets[bullets.length-1].y < player.y-40) {
    bullets.push({ x: player.x+player.w/2-3, y: player.y, w: 6, h: 12 });
  }
}

function gameOver() {
  gameRunning = false;
  alert("–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞! –û—á–∫–∏: " + score);
}
</script>
</body>
</html>
